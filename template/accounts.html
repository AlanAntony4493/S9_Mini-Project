{% extends "base.html" %}
{% load static %}
{% block content %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounting Software</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
        }
    
        #transactionForm {
            max-width: 400px;
            margin: 10px auto;
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
    
        #transactionForm label {
            display: block;
            margin-bottom: 8px;
        }
    
        #transactionForm input {
            width: calc(100% - 10px);
            padding: 10px;
            margin-bottom: 15px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
    
        #transactionForm button {
            width: 100%;
            background-color: #007bff;
            color: #fff;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    
        #transactionForm button:hover {
            background-color: #0056b3;
        }
    
        table {
            width: 80%;
            border-collapse: collapse;
            margin-top: 20px;
            margin-left:10%;
            margin-right:10%;
            margin-bottom:40px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
    
        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
    
        th {
            background-color: #007bff;
            color: #fff;
        }
    
        tfoot {
            background-color: #f8f9fa;
        }
    
        button[type="button"] {
            background-color: #28a745;
            color: #fff;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    
        button[type="button"]:hover {
            background-color: #218838;
        }

        h2 {
            font-size: 24px;
            margin-bottom: 20px;
            margin-left: 40px;
            color: #007bff;
            font-family: 'Helvetica', sans-serif;
        }
    </style>
    
</head>

<body>
              <!-- Breadcrumbs -->
              <section class="breadcrumbs">
                <div class="container">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2>Accounts</h2>
                    </div>
                </div>
            </section>
            <!-- End Breadcrumbs -->
    <!-- Transaction Form -->


    <!-- Transaction Table -->
    <table id="transactionTable">
        <thead>
            <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Credit</th>
                <th>Debit</th>
                <th>Bill/Invoice Number</th>
            </tr>
        </thead>
        <tbody>
            <!-- Transaction rows will be added dynamically here -->
        </tbody>
        <tfoot>
            <tr>
                <td><strong>Total:</strong></td>
                <td></td>
                <td id="totalCredit">0</td>
                <td id="totalDebit">0</td>
                <td></td>
            </tr>
        </tfoot>
    </table>

    <form id="transactionForm">
        <h2>ADD TRANSACTIONS</h2>
        <label for="date">Date:</label>
        <input type="date" id="date" onchange="validateTransactionDate()" required placeholder="Select date">
    
        <label for="description">Description:</label>
        <input type="text" id="description" required placeholder="Enter description">
    
        <div style="display: flex; gap: 10px;">
            <div style="flex: 1;">
                <label for="credit">Credit:</label>
                <input type="text" id="credit" oninput="validateCreditDebit()" placeholder="Enter credit amount">
            </div>
            <div style="flex: 1;">
                <label for="debit">Debit:</label>
                <input type="text" id="debit" oninput="validateCreditDebit()" placeholder="Enter debit amount">
            </div>
        </div>
    
        <label for="billNumber">Bill/Invoice Number:</label>
        <input type="text" id="billNumber" pattern="[a-zA-Z0-9]+" title="Should contain only letters and numbers" required
            placeholder="Enter bill/invoice number">
    
        <button type="button" onclick="addTransaction()">Add Transaction</button>
    </form>

    <script>
        function addTransaction() {
            // Get form values
            var dateInput = document.getElementById('date');
            var description = document.getElementById('description').value.trim();
            var credit = document.getElementById('credit').value.trim();
            var debit = document.getElementById('debit').value.trim();
            var billNumber = document.getElementById('billNumber').value.trim();

            // Validate date is not empty
            if (dateInput.value === '') {
                alert("Date is required.");
                return;
            }

            // Validate current month and past or current date
            var currentDate = new Date();
            var inputDate = new Date(dateInput.value);
            var startOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);

            if (inputDate < startOfMonth || inputDate > currentDate) {
                alert("You can only add transactions for the current month and up to today.");
                return;
            }

            // Validate description is not empty
            if (description === '') {
                alert("Description is required.");
                return;
            }

            // Validate either credit or debit is filled
            if (credit === '' && debit === '') {
                alert("Either Credit or Debit should be filled.");
                return;
            }

            // Validate credit and debit as numbers
            if (credit !== '' && isNaN(credit)) {
                alert("Credit should be a number.");
                return;
            }

            if (debit !== '' && isNaN(debit)) {
                alert("Debit should be a number.");
                return;
            }

            // Validate Bill/Invoice Number
            if (billNumber === '') {
                alert("Bill/Invoice Number is required.");
                return;
            }

            // Create a new row for the table
            var newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${dateInput.value}</td>
                <td>${description}</td>
                <td>${credit}</td>
                <td>${debit}</td>
                <td>${billNumber}</td>
            `;

            // Append the new row to the table
            document.getElementById('transactionTable').getElementsByTagName('tbody')[0].appendChild(newRow);

            // Clear the form fields
            dateInput.value = '';
            document.getElementById('description').value = '';
            document.getElementById('credit').value = '';
            document.getElementById('debit').value = '';
            document.getElementById('billNumber').value = '';

            // Reset the form to its initial state
            document.getElementById('transactionForm').reset();

            // Enable both credit and debit inputs after adding a transaction
            document.getElementById('credit').disabled = false;
            document.getElementById('debit').disabled = false;

            // Update total credit and debit
            updateTotals();
        }

        // Validate either credit or debit is selected
        function validateCreditDebit() {
            var credit = document.getElementById('credit').value;
            var debit = document.getElementById('debit').value;

            // Disable the other input based on user selection
            if (credit !== '') {
                document.getElementById('debit').disabled = true;
            } else if (debit !== '') {
                document.getElementById('credit').disabled = true;
            } else {
                document.getElementById('credit').disabled = false;
                document.getElementById('debit').disabled = false;
            }
        }

        // Validate transaction date to be in the current month and not in the future
        function validateTransactionDate() {
            var dateInput = document.getElementById('date');
            var selectedDate = new Date(dateInput.value);
            var currentDate = new Date();

            var startOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);

            if (selectedDate < startOfMonth || selectedDate > currentDate) {
                alert("You can only select dates in the current month and up to today.");
                dateInput.value = ''; // Clear the invalid date
            }
        }

        // Update total credit and debit
        function updateTotals() {
            var totalCredit = 0;
            var totalDebit = 0;

            // Iterate through rows and update totals
            var rows = document.getElementById('transactionTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr');

            for (var i = 0; i < rows.length; i++) {
                var creditCell = rows[i].getElementsByTagName('td')[2];
                var debitCell = rows[i].getElementsByTagName('td')[3];

                if (creditCell && !isNaN(creditCell.textContent) && creditCell.textContent.trim() !== '') {
                    totalCredit += parseFloat(creditCell.textContent);
                }

                if (debitCell && !isNaN(debitCell.textContent) && debitCell.textContent.trim() !== '') {
                    totalDebit += parseFloat(debitCell.textContent);
                }
            }

            // Update the total fields
            document.getElementById('totalCredit').textContent = totalCredit.toFixed(2);
            document.getElementById('totalDebit').textContent = totalDebit.toFixed(2);
        }
    </script>
</body>

</html>
{% endblock %}